birth_2 <- birth %>% filter(!str_length(birth)<5) %>% filter( str_detect(birth,"^\\D")) %>% mutate(birth = str_replace_all(birth,rule)) %>% mutate(birth = paste("1/",birth,sep = "")) %>% mutate(birth = as.Date(birth, format = '%d/%m/%y'))
df <- rbind(birth_1, birth_2)
df<- df %>% mutate(birth=year(birth)) %>% filter(!(birth>2012)) %>% filter(!(birth<1999))
ggplot(df, aes(x=birth)) +
geom_histogram(binwidth = 1, colour="black", fill = "#9FC29F",position = position_nudge(-0.5))+
scale_x_continuous(breaks = 1998:2012) +
labs(x= "Year", y = "Dog Birth Counts") +
ggtitle("NYC Dog Birth Year Histogram") +
theme(plot.title = element_text(face = "bold")) +
theme(plot.subtitle = element_text(face = "bold", color = "grey35"))
rule <- c("BLACK", "BLOND", "BROWN", "TAN", "WHITE")
df <- NYCdog %>% select(dominant_color, Group) %>% mutate(dominant_color = if_else(dominant_color %in% rule, dominant_color, "OTHER" )) %>% group_by(dominant_color, Group)
df$dominant_color <- as.factor(df$dominant_color)
df$dominant_color <- factor(df$dominant_color, levels = c("BLACK", "BLOND", "BROWN", "TAN", "WHITE","OTHER"))
mosaic(dominant_color~Group, df, direction = c("v","h"), set_labels=list(dominant_color = c("Black", "Blond", "Brown", "Tan", "White","Other")))
df <- NYCdog %>% select(dominant_color, Group) %>% filter(dominant_color %in% rule) %>% group_by(dominant_color, Group)
df$dominant_color <- as.factor(df$dominant_color)
df$dominant_color <- factor(df$dominant_color, levels = c("BLACK", "BLOND", "BROWN", "TAN", "WHITE"))
mosaic(dominant_color~Group, df, direction = c("v","h"), set_labels=list(dominant_color = c("Black", "Blond", "Brown", "Tan", "White")))
df <- NYCdog %>% select(zip_code, spayed_or_neutered) %>% mutate(spayed_or_neutered = if_else(spayed_or_neutered == "Yes", 1, 0)) %>% group_by(zip_code) %>% summarise_all(funs(sum(.=='1')/n()*100)) %>% mutate(zip_code = as.character(zip_code))
names(df) <- c("region","value")
nyc_county_fips = c(36005, 36047, 36061, 36081, 36085)
zip_choropleth(df, county_zoom = nyc_county_fips, title = "Spatial Heat Map of The Percent Spayed or Neutered Dogs",legend = "Percent")
from <- today() - years(1)
AAPL <- tq_get("AAPL", get = "stock.prices", from = from) %>% select(date, adjusted)
AMZN <-  tq_get("AMZN", get = "stock.prices", from = from) %>% select(date, adjusted)
GOOG <-  tq_get("GOOG", get = "stock.prices", from = from) %>% select(date, adjusted)
MSFT <-  tq_get("MSFT", get = "stock.prices", from = from) %>% select(date, adjusted)
ggplot() +
geom_line(data = AAPL, aes(x=date, y= adjusted, colour = "AAPL"), size = 1.2) +
geom_line(data = AMZN, aes(x=date, y= adjusted, colour = "AMZN"), size = 1.2) +
geom_line(data = GOOG, aes(x=date, y= adjusted, colour = "GOOG"), size = 1.2) +
geom_line(data = MSFT, aes(x=date, y= adjusted, colour = "MSFT"), size = 1.2) +
labs(x= "Date", y = "Stock Price") +
ggtitle("Four Tech Companies Stock Prices") +
theme(plot.title = element_text(face = "bold")) +
theme(plot.subtitle = element_text(face = "bold", color = "grey35"))+
scale_x_date(date_breaks = "1 month",date_labels = "%b-%y")
AAPL$adjusted = AAPL$adjusted / AAPL$adjusted[1] * 100
AMZN$adjusted = AMZN$adjusted / AMZN$adjusted[1] * 100
GOOG$adjusted = GOOG$adjusted / GOOG$adjusted[1] * 100
MSFT$adjusted = MSFT$adjusted / MSFT$adjusted[1] * 100
ggplot() +
geom_line(data = AAPL, aes(x=date, y= adjusted, colour = "AAPL"), size = 1.2, alpha=0.8) +
geom_line(data = AMZN, aes(x=date, y= adjusted, colour = "AMZN"), size = 1.2, alpha=0.8) +
geom_line(data = GOOG, aes(x=date, y= adjusted, colour = "GOOG"), size = 1.2, alpha=0.8) +
geom_line(data = MSFT, aes(x=date, y= adjusted, colour = "MSFT"), size = 1.2, alpha=0.8) +
labs(x= "Date", y = "Stock Price") +
ggtitle("Four Tech Companies Stock Price Change % for last 365 Days") +
theme(plot.title = element_text(face = "bold")) +
theme(plot.subtitle = element_text(face = "bold", color = "grey35"))+
scale_x_date(date_breaks = "1 month",date_labels = "%b-%y")
df <- NYCdog %>% select(breed, zip_code, spayed_or_neutered) %>% filter(str_detect(breed,"Pit")) %>%filter(str_detect(spayed_or_neutered,"No")) %>% group_by(zip_code) %>% summarise(n=n()) %>% mutate(zip_code = as.character(zip_code))
names(df) <- c("region","value")
nyc_county_fips = c(36005, 36047, 36061, 36081, 36085)
zip_choropleth(df, county_zoom = nyc_county_fips, title = "Registered Non-spayed or Non-neutered Pit Bulls in NYC", legend = "Dog Dounts")
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
df <- hw4_df %>% select(OU2H, Q3Q4) %>%
mutate(performance = if_else(OU2H > Q3Q4, 'Overestimate', 'Underestimate'))
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
library(tidyverse)
df <- read_csv('tidy.csv')
hw4_df <- df %>% select(Date,V, H, V1, V2, V3, V4, H1, H2, H3, H4, OU2H) %>%
mutate(Year = format(Date, "%Y") ) %>%
mutate(Q3Q4 = V3+V4+H3+H4) %>%
mutate(Q1Q2 = V1+V2+H1+H2) %>%
mutate(Q1 = V1+H1) %>%
select(Year, Q1, Q1Q2, Q3Q4, OU2H, V, H)
df <- hw4_df %>% select(OU2H, Q3Q4) %>%
mutate(performance = if_else(OU2H > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous("Percentage of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(OU2H, Q3Q4) %>%
mutate(performance = if_else(OU2H > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous("Percentage of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4, OU2H) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000)) +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(Q1, Q3Q4, OU2H) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous("Percentage of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(Q1Q2, Q3Q4, OU2H) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000)) +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(Q1Q2, Q3Q4, OU2H) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous("Percentage of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost'))
ggplot(df, aes(x = Year, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(Q1Q2, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost'))
ggplot(df, aes(x = Year, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1Q2, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
df <- hw4_df %>% select(V, H, Q1Q2, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")+
facet_wrap(Year)
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West')) %>%
group_by(Year)
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")+
facet_wrap(Year)
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")+
facet_wrap(~Year)
df <- hw4_df %>% select(V, H, Q1Q2, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance")
East <- c("Atlanta", "Boston", "Brooklyn", "Charlotte", "Chicago", "Cleveland", "Detroit", "Indiana", "Miami", "Milwaukee","NewYork","Orlando","Philadelphia","Toronto","Washington")
df <- hw4_df %>% select(V, H, Q1, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>2*Q1))|(OU2H<Q3Q4)&(OU2H<2*Q1) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance") +
facet_wrap(~Year)
df <- hw4_df %>% select(V, H, Q1Q2, Q3Q4, OU2H, Year) %>%
mutate(performance = if_else( ((OU2H>Q3Q4)&(OU2H>Q1Q2))|(OU2H<Q3Q4)&(OU2H<Q1Q2) ,'Gain','Lost')) %>%
mutate(Vside = if_else(V %in% East, 'East', 'West')) %>%
mutate(Hside = if_else(H %in% East, 'East', 'West')) %>%
mutate(side = if_else( Vside == Hside, if_else(Vside == 'East', 'East', 'West'), 'East-West'))
ggplot(df, aes(x = side, fill = performance)) +
geom_bar(position = "dodge") +
scale_y_continuous("Number of Games") +
scale_x_discrete("Predicited 2nd Half Score Performance") +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4))
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4))
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4))
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4))
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4))
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4)) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4, alpha= 0.5)) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4, alpha= 0.25)) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4), alpha= 0.25) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4), alpha= 0.1) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4)) +
facet_wrap(~Year)
df <- hw4_df %>% select( Q1, Q1Q2, Q3Q4, Year)
ggplot(df) +
geom_point(aes(x=Q1,y=Q3Q4), alpha= 0.1) +
facet_wrap(~Year)
ggplot(df) +
geom_point(aes(x=Q1Q2, y=Q3Q4), alpha= 0.1) +
facet_wrap(~Year)
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 1000, 2000, 3000, 4000, 5000, 6000, 7000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games") +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games") +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games") +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score")
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score")+
coord_cartesian(ylim=c(0,0.6))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,0.6))
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score")+
coord_cartesian(ylim=c(0,0.55))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,0.55))
df <- hw4_df %>% select(Q1, Q3Q4) %>%
mutate(performance = if_else(Q1*2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("House Predicited 2nd Half Score")+
coord_cartesian(ylim=c(0,0.55))
df <- hw4_df %>% select(Q1Q2, Q3Q4) %>%
mutate(performance = if_else(Q1Q2 > Q3Q4, 'Overestimate', 'Underestimate'))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar() +
scale_y_continuous("Number of Games", breaks = c(0, 2000, 4000, 6000, 8000)) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,8000))
ggplot(df, aes(x = performance, fill = performance)) +
geom_bar(aes(y=(..count..)/sum(..count..))) +
scale_y_continuous("Number of Games", breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), labels = c('0%', '10%', '20%', '30%', '40%', '50%')) +
scale_x_discrete("House Predicited 2nd Half Score") +
coord_cartesian(ylim=c(0,0.55))
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
library(tidyverse)
finl_df <- read_csv("../data/tidy.csv")
setwd("D:/Dropbox/02_DSI_Class/04_2018 Fall/1_EDAV/Final project/groupproject/Scripts")
setwd("D:/Dropbox/02_DSI_Class/04_2018 Fall/1_EDAV/Final project/groupproject/Scripts")
finl_df <- read_csv("../data/tidy.csv")
View(finl_df)
df <- final_df %>% select(Total)
# import data and library
library(tidyverse)
final_df <- read_csv("../data/tidy.csv") %>% select(Date, SZN, V, H, V1, V2, V3, V4, H1, H2, H3, H4, VF, HF, OUOpen, OUClose, OU2H, VSpread2H, HSpread2H) %>% mutate(Total = VF+HF) %>% mutate(Total_2H = V3+V4+H3+H4)
