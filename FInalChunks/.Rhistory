df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(color = "brown") +
labs(x="Betting Profit", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team")
tidy <- read_csv("../Data/tidy.csv")
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(color = "brown") +
labs(x="Betting Profit", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team") +
theme_bw()
tidy <- read_csv("../Data/tidy.csv")
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(color = "brown", size = 3) +
labs(x="Profit ($)", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team") +
theme_bw()
tidy <- read_csv("../Data/tidy.csv")
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(fill = "brown", color = "black" size = 3) +
tidy <- read_csv("../Data/tidy.csv")
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(fill = "brown", color = "black", size = 3) +
labs(x="Profit ($)", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team") +
theme_bw()
tidy <- read_csv("../Data/tidy.csv")
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point(color = "brown", size = 2) +
labs(x="Profit ($)", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team") +
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(tidyverse)
library(dygraphs)
library(xts)
library(GGally)
library(gridExtra)
library(knitr)
combined = read_csv("../Data/combined.csv")[-c(1)]
intermediate = read_csv("../Data/intermediate.csv")
tidy = read_csv("../Data/tidy.csv")
options(dplyr.width = Inf)
kable(combined[1:5,], caption = "Untidy Data")
kable(tidy[1:5, c(2, 4, 6, 7, 8, 9, 14, 16, 18, 22, 24)], caption = "Tidy Data")
kable(unique(combined$Team))
df <- tidy  %>% select(Date, OUOpen, OUClose, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen)
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(tidyverse)
library(dygraphs)
library(xts)
library(GGally)
library(gridExtra)
library(knitr)
combined = read_csv("../Data/combined.csv")[-c(1)]
intermediate = read_csv("../Data/intermediate.csv")
tidy = read_csv("../Data/tidy.csv")
options(dplyr.width = Inf)
kable(combined[1:4,], caption = "Untidy Data")
kable(tidy[1:5, c(2, 4, 6, 7, 8, 9, 14, 16, 18, 22, 24)], caption = "Tidy Data")
unique(combined$Team)
kable((combined %>% filter(`2H` == 'pk'))[1:5,],
caption = "Pick 'em Examples *Notice column '2H'")
kable(combined[c(1975,23521),], caption = "Faulty Over/Under Cases")
quarter_scores <- intermediate %>%
select(V1, V2, V3, V4, H1, H2, H3, H4)
quarter_scores <-gather(quarter_scores, key = "Quarter", value = "Score")
before <- ggplot(quarter_scores, aes(x = Quarter, y = Score)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Quarter Point Totals Before Adjustments") +
labs(x = "Quarter",
y = "Number of Points",
caption = "V = visitor, H = home") +
theme_bw()
quarter_scores <- tidy %>%
select(V1, V2, V3, V4, H1, H2, H3, H4)
quarter_scores <- gather(quarter_scores, key = "Quarter", value = "Score")
after <- ggplot(quarter_scores, aes(x = Quarter, y = Score)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Quarter Point Totals After Adjustments") +
labs(x = "Quarter",
y = "Number of Points",
caption = "V = visitor, H = home") +
theme_bw()
grid.arrange(before, after, ncol = 2, widths = c(9, 9))
OUs <- intermediate %>%
select(OUOpen, OUClose)
OUs <- gather(OUs, key = "OpenClose", value = "Value")
before <- ggplot(OUs, aes(x = OpenClose, y = Value)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Over/Under Scores at the Open and Close Before Adjustments") +
labs(x = "Open/Close",
y = "Over/Under for the Total Number of Points") +
theme_bw()
OUs <- tidy %>%
select(OUOpen, OUClose)
OUs <- gather(OUs, key = "OpenClose", value = "Value")
after <- ggplot(OUs, aes(x = OpenClose, y = Value)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Over/Under Scores at the Open and Close After Adjustments") +
labs(x = "Open/Close",
y = "Over/Under for the Total Number of Points") +
theme_bw()
grid.arrange(before, after, ncol = 2, widths = c(9, 9))
Tots <- intermediate %>%
select(VF, HF)
Tots <- gather(Tots, key = "Team", value = "Value")
before <- ggplot(Tots, aes(x = Team, y = Value)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Game Point Totals Before Adjustments") +
labs(x = "Visitor/Home Final Score",
y = "Total Number of Points") +
theme_bw()
Tots <- tidy %>%
select(VF, HF)
Tots <- gather(Tots, key = "Team", value = "Value")
after <- ggplot(Tots, aes(x = Team, y = Value)) +
geom_boxplot(fill = "brown", color = "black") +
ggtitle("Boxplots of Game Point Totals After Adjustments") +
labs(x = "Visitor/Home Final Score",
y = "Total Number of Points") +
theme_bw()
grid.arrange(before, after, ncol = 2, widths = c(9, 9))
tidy <- tidy %>%
select(Date, SZN, V, H, V1, V2, V3, V4, H1, H2, H3, H4,
VF, HF, OUOpen, OUClose, OU2H, VMoney, HMoney) %>%
mutate(Total = VF+HF) %>%
mutate(Total_2H = V3+V4+H3+H4)
df <- tidy %>%
select(OUOpen, OUClose) %>%
mutate(Diff = OUClose - OUOpen)
histo <- ggplot(df, aes(x = Diff)) +
geom_histogram(binwidth = 0.5, fill='brown', color='black') +
xlab("Score Difference") +
ylab("Frequency Count") +
ggtitle("Histogram of Changes in Over/Under Values (OUClose-OUOpen)") +
theme_bw()
box <- ggplot(df, aes(y= Diff)) +
geom_boxplot(fill = "brown") +
scale_x_discrete() +
xlab("(OUClose - OUOpen)") +
ylab("Score Difference") +
ggtitle("Boxplot of Changes in Over/Under Values (OUClose-OUOpen)") +
theme_bw()
qq <- ggplot(df, aes(sample = Diff)) +
geom_qq() +
stat_qq_line(distribution = qnorm, color= "brown", size = 2) +
xlab("Theoratical") +
ylab("Score Difference") +
ggtitle("QQ-Plot of Changes in Over/Under Values (OUClose-OUOpen)") +
theme_bw()
df <- tidy %>% select(OUClose, OU2H) %>% mutate(Ratio = OUClose / OU2H)
scat <- ggplot(df, aes(x = OUClose, y = OU2H)) +
geom_point(alpha = 0.05) +
geom_smooth(method = lm, se = FALSE, color = "brown", show.legend = TRUE, size = 2) +
scale_x_continuous("Over/Under Scores for Full Game",
breaks = c(170, 180, 190, 200, 210, 220, 230, 240),
labels = c("170", "180", "190", "200", "210", "220", "230", "240")) +
scale_y_continuous("Over/Under Scores for 2nd Half",
breaks = c(85,90,95,100,105,110,115,120),
labels = c("85","90","95","100","105","110","115","120")) +
ggtitle("Over/Under Scores at the Close for Full Game vs. 2nd Half") +
theme_bw()
grid.arrange(histo, box, qq, scat, ncol = 2)
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.49, -4.49, -3.49, -2.49, -1.49, -0.49,
0.49, 1.49, 2.49, 3.49, 4.49, 5.49, Inf),
labels = c("<= -6","-5","-4", "-3", "-2", "-1", "skip",
"1", "2", "3", "4", "5", ">= 6"))) %>%
filter(!(Diff_dec_idx == "skip")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95,
if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>%
summarise(profit = sum(earning)) %>%
filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity', fill = "brown", color = "black") +
xlab("Open-to-Close Over/Under Change") +
ylab("Profit ($)") +
ggtitle("Profit by Betting System Based on Open-to-Close Score Change") +
theme_bw()
df <- tidy  %>% select(Date, OUOpen, OUClose, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen)
df$Profit = 0
for (i in 2:length(df$Profit)){
if (df$OU2H[i] > df$Total_2H[i]) {
df$Profit[i] <- df$Profit[i - 1] + 95
}
else if (df$OU2H[i] < df$Total_2H[i]) {
df$Profit[i] <- df$Profit[i - 1] - 100
}
else {
df$Profit[i] <- df$Profit[i - 1]
}
}
ggplot(df, aes(y = Profit, x = Date, col = "Profit")) +
geom_line(lwd = 0.1) +
geom_ribbon(aes(x = Date, ymax = Profit), ymin = 0, alpha=0.3,
fill = "darkgreen", color = "darkgreen") +
geom_hline(aes(yintercept = min(Profit), colour = "Low"), alpha = 0.8, lwd = 1,
linetype="dotdash") +
geom_hline(aes(yintercept = Profit[14186], colour = "Finish"), alpha = 0.8,
lwd = 1, linetype="dotdash") +
ggtitle("Profit Over Time by Betting 'Under' for 2nd Half Over/Under") +
scale_color_manual(values = c('Profit' = 'darkgreen', "Low" = "red",
"High" = "blue", "Finish" = "black")) +
labs(x = "Date", y = "Running Profit ($)", color = "Legend:") +
theme_bw()
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
# generate total score and total 2H score
library(tidyverse)
tidy <- read_csv("../data/tidy.csv") %>%
select(Date, SZN, V, H, V1, V2, V3, V4, H1, H2, H3, H4, VF, HF, OUOpen, OUClose, OU2H, VMoney, HMoney) %>%
mutate(Total = VF+HF) %>%
mutate(Total_2H = V3+V4+H3+H4)
df <- tidy %>% select(OUClose, OU2H) %>% mutate(Ratio = OUClose / OU2H)
ggplot(df, aes(x = OUClose, y = OU2H)) +
geom_point(alpha = 0.05) +
geom_smooth(se = FALSE) + #using method = 'loess'
geom_smooth(method = lm, se = FALSE, color = "red") +
scale_x_continuous("House Over/Under Close Score", breaks = c(170, 180, 190, 200, 210, 220, 230, 240), labels = c("170", "180", "190", "200", "210", "220", "230", "240")) +
scale_y_continuous("House Over/Under 2nd Half Score", breaks = c(85,90,95,100,105,110,115,120), labels = c("85","90","95","100","105","110","115","120")) +
ggtitle("Over/Under Close Score VS. Over/Under 2nd Half Score")
ggplot(df, aes(x = seq(1, length(tidy$OUClose)),y = OUClose/OU2H)) +
geom_point(alpha = 0.1) +
ggtitle("Ratio Over/Under Close Score and Over/Under 2nd Half Score") +
scale_x_continuous("Game Index", breaks = c(0, 2500, 5000, 7500, 10000, 12500), labels = c("0", "2500", "5000", "7500", "10000", "12500")) +
scale_y_continuous("OUClose/OU2H", breaks = c(1.9, 2.0 , 2.1 , 2.2), labels = c("1.9", "2.0" , "2.1" , "2.2")) +
geom_smooth(se = FALSE) + #using method = 'loess'
geom_smooth(method = lm, se = FALSE, color = "red")
df <- tidy %>%
select(OUOpen, OUClose) %>%
mutate(Diff = OUClose - OUOpen)
ggplot(df, aes(x = Diff)) +
geom_histogram(binwidth = 0.5, fill='lightblue', color='black') +
xlab("Score Difference") +
ylab("Counts") +
ggtitle("Over/Under Score Difference Histogram")
ggplot(df, aes(y= Diff)) +
geom_boxplot() +
scale_x_discrete() +
ylab("Score Difference") +
ggtitle("Over/Under Score Difference Boxplot")
ggplot(df, aes(sample = Diff)) +
geom_qq() +
stat_qq_line(distribution = qnorm) +
xlab("Theoratical") +
ylab("Socre Difference") +
ggtitle("Score Difference QQ-Plot")
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.51, -4.51, -3.51, -2.51, -1.51, -0.49, 0.49, 1.51, 2.51, 3.51, 4.51, 5.51, Inf),
labels = c("<=-6","-5~-5.5","-4~-4.5", "-3~-3.5", "-2~-2.5", "-0.5~-1.5", "skip -1 to 1", "0.5~1.5", "2~2.5", "3~3.5","4~4.5", "5~5.5", ">=6"))) %>%
filter(!(Diff_dec_idx == "skip -1 to 1")) %>%
mutate(earning = if_else( (Total-OUClose)*(Diff)>0, 95, if_else(Total==OUClose, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>% summarise(profit = sum(earning))
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity') +
xlab("Score Difference") +
ylab("Profit ($)") +
ggtitle("Placing Bet On Over OUClose if Score Difference is Positive, and Vice Versa")
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.51, -4.51, -3.51, -2.51, -1.51, -0.49, 0.49, 1.51, 2.51, 3.51, 4.51, 5.51, Inf),
labels = c("<=-6","-5&-5.5","-4&-4.5", "-3&-3.5", "-2&-2.5", "-0.5&-1.5", "skip -1 to 1", "0.5&1.5", "2&2.5", "3&3.5","4&4.5", "5&5.5", ">=6"))) %>%
filter(!(Diff_dec_idx == "skip -1 to 1")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95, if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>% summarise(profit = sum(earning))
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity') +
xlab("Score Difference") +
ylab("Profit ($)") +
geom_text(aes(label = paste(profit), vjust=if_else(profit>0,-0.5,1))) +
ggtitle("Placing Bet On Over OU2H if Score Difference is Positive, and Vice Versa")
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -4.9, -3.9, -2.9, -1.9, -0.9, -0.49, 0.49, 0.9, 1.9, 2.9, 3.9, 4.9, Inf),
labels = c("-5","-4","-3", "-2", "-1", "-0.5", "0", "0.5", "1", "2","3", "4", "5"))) %>%
filter(!(Diff_dec_idx == "skip -1 to 1")) %>%
mutate(earning = if_else( (Total_2H-OU2H)<0, 95, if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>% summarise(profit = sum(earning)) %>% filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity') +
xlab("Score Difference") +
ylab("Profit ($)") +
ggtitle("Placing Bet On Under OU2H for All Games")
df <- tidy %>% select(OU2H, Total_2H)
df <- tidy %>%
select(V, H, VF, HF, VMoney, HMoney) %>%
mutate(Bet_V_win = if_else(VF>HF, if_else(VMoney>0, VMoney, -100/VMoney*100), if_else(VF<HF, -100, 0))) %>%
mutate(Bet_H_win = if_else(VF<HF, if_else(HMoney>0, HMoney, -100/HMoney*100), if_else(VF>HF, -100, 0)))
df_V <- df %>%
group_by(V) %>% summarise_at("Bet_V_win", sum) %>%
rename(Team = V)
df_H <- df %>%
group_by(H) %>% summarise_at("Bet_H_win", sum) %>%
rename(Team = H)
df_Team <- df_V %>%
inner_join(df_H) %>%
mutate(profit = Bet_V_win + Bet_H_win)
ggplot(df_Team, aes(x= profit, y= fct_reorder(Team, profit))) +
geom_point() +
labs(x="Betting Profit", y="NBA Team") +
ggtitle("Cleveland Dot Plot of Net Profit by Betting on Same Team")
df <- tidy %>% select(Total, Total_2H, OU2H, OUClose)
ggplot(df, aes(x=Total_2H, y= OU2H)) +
geom_point(alpha = 0.1) +
geom_abline(color = "red")
ggplot(df, aes(x = seq(1, length(tidy$Total)),y = (Total-Total_2H)/Total_2H)) +
geom_point(alpha = 0.1) +
ggtitle("1st Half Score and 2nd Hlaf Score Ratio") +
scale_x_continuous("Game Index", breaks = c(0, 2500, 5000, 7500, 10000, 12500), labels = c("0", "2500", "5000", "7500", "10000", "12500")) +
ylab("1st Half Score/2nd Half Score") +
geom_smooth(se = FALSE) + #using method = 'loess'
geom_smooth(method = lm, se = FALSE, color = "red")
ggplot(df, aes(x=(Total-Total_2H)/Total_2H, y=(OUClose-OU2H)/OU2H)) +
geom_point(alpha = 0.05) +
ggtitle("House 1st/2nd Score Ratio vs Actual 1st/2nd Game Score Ratio") +
xlab("Actual 1st/2nd Score") +
ylab("House 1st/2nd Score") +
geom_hline(yintercept=1, color = "red", alpha = 0.5) +
geom_vline(xintercept=1, color = "red", alpha = 0.5)
df <- tidy %>%
select(Total, Total_2H) %>%
mutate(Total_1H = Total - Total_2H) %>%
mutate(index = if_else(Total_1H>Total_2H, "Positve", if_else(Total_1H==Total_2H, "equal", "Negative")))
ggplot(df, aes(x=index, y=..count..)) +
geom_bar() +
ggtitle("Counts for 1st and 2nd game score comparsion (acutal)")
df <- tidy %>%
select(OUClose, OU2H) %>%
mutate(OU1H = OUClose - OU2H) %>%
mutate(index = if_else(OU1H>OU2H, "Positve", if_else(OU1H==OU2H, "equal", "Negative")))
ggplot(df, aes(x=index, y=..count..)) +
geom_bar() +
ggtitle("Counts for 1st and 2nd game score comparsion (OUClose, OU2H)")
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.49, -4.49, -3.49, -2.49, -1.49, -0.49,
0.49, 1.49, 2.49, 3.49, 4.49, 5.49, Inf),
labels = c("<= -6","-5","-4", "-3", "-2", "-1", "skip",
"1", "2", "3", "4", "5", ">= 6"))) %>%
filter(!(Diff_dec_idx == "skip")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95,
if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>%
summarise(profit = sum(earning)) %>%
filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity', fill = "brown", color = "black") +
xlab("Open-to-Close Over/Under Change") +
ylab("Profit ($)") +
geom_text(aes(label = paste(profit), vjust=if_else(profit>0,-0.5,1))) +
ggtitle("Profit by Betting System Based on Open-to-Close Score Change") +
theme_bw()
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.49, -4.49, -3.49, -2.49, -1.49, -0.49,
0.49, 1.49, 2.49, 3.49, 4.49, 5.49, Inf),
labels = c("<= -6","-5","-4", "-3", "-2", "-1", "skip",
"1", "2", "3", "4", "5", ">= 6"))) %>%
filter(!(Diff_dec_idx == "skip")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95,
if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>%
summarise(profit = sum(earning)) %>%
filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity', fill = "brown", color = "black") +
xlab("Open-to-Close Over/Under Change") +
ylab("Profit ($)") +
geom_text(aes(label = paste(profit), vjust=if_else(profit>0,-0.5,1)), size = 3) +
ggtitle("Profit by Betting System Based on Open-to-Close Score Change") +
theme_bw()
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.49, -4.49, -3.49, -2.49, -1.49, -0.49,
0.49, 1.49, 2.49, 3.49, 4.49, 5.49, Inf),
labels = c("<= -5.5","-5 to -4.5","-4 to -3.5", "-3 to -2.5",
"-2 to -1.5", "-1 to -0.5", "skip",
"0.5 to 1", "1.5 to 2", "2.5 to 3",
"3.5 to 4", "4.5 to 5", ">= 5.5"))) %>%
filter(!(Diff_dec_idx == "skip")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95,
if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>%
summarise(profit = sum(earning)) %>%
filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity', fill = "brown", color = "black") +
xlab("Open-to-Close Over/Under Change") +
ylab("Profit ($)") +
geom_text(aes(label = paste(profit), vjust=if_else(profit>0,-0.5,1)), size = 3) +
ggtitle("Profit by Betting System Based on Open-to-Close Score Change") +
theme_bw()
df <- tidy %>%
select(OUOpen, OUClose, Total, OU2H, Total_2H) %>%
mutate(Diff = OUClose-OUOpen) %>%
mutate(Diff_dec_idx =
cut(Diff,
breaks = c(-Inf, -5.49, -4.49, -3.49, -2.49, -1.49, -0.49,
0.49, 1.49, 2.49, 3.49, 4.49, 5.49, Inf),
labels = c("<= -5.5","-5 & -4.5","-4 & -3.5", "-3 & -2.5",
"-2 & -1.5", "-1 & -0.5", "skip",
"0.5 & 1", "1.5 & 2", "2.5 & 3",
"3.5 & 4", "4.5 & 5", ">= 5.5"))) %>%
filter(!(Diff_dec_idx == "skip")) %>%
mutate(earning = if_else( (Total_2H-OU2H)*(Diff)>0, 95,
if_else(Total_2H==OU2H, 0, -100) ) )
df2 <- df %>%  group_by(Diff_dec_idx) %>%
summarise(profit = sum(earning)) %>%
filter(as.numeric(Diff_dec_idx)>0)
ggplot(df2, aes(x=Diff_dec_idx, y = profit)) +
geom_bar(stat='identity', fill = "brown", color = "black") +
xlab("Open-to-Close Over/Under Change") +
ylab("Profit ($)") +
geom_text(aes(label = paste(profit), vjust=if_else(profit>0,-0.5,1)), size = 3) +
ggtitle("Profit by Betting System Based on Open-to-Close Score Change") +
theme_bw()
